pipeline {
    agent {
        label 'alma-ansible'
    }
    stages {
        stage('Checkout and Pull') {
            steps {
                dir('$WORKSPACE/ansible-playbooks') {
                    git branch: 'main', url: 'https://github.com/DivakarK22/ansible-playbooks.git'
                }
            }
        }
        stage('Updating Inventory file') {
            steps {
                script {
                    // Define multi-line text
                    def multilineText = '''
                        192.168.1.10
                    '''
                    
                    // Write multi-line text to a file
                    writeFile file: '/etc/ansible/hosts', text: multilineText
                    
                    // Verify the file content
                    echo "File content:"
                    sh "cat /etc/ansible/hosts"
            }
        }
        stage('Tasks') {
            steps {
                sh 'ansible-playbook $WORKSPACE/jenkins-playbooks/test.yml  || true'
            }
        }          
    }
}